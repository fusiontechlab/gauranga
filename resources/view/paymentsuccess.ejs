<%- include('common/header') %>
  <%- include('common/nav') %>

   <style>
     @supports (animation: grow .5s cubic-bezier(.25, .25, .25, 1) forwards) {
	 .tick {
		 stroke-opacity: 0;
		 stroke-dasharray: 29px;
		 stroke-dashoffset: 29px;
		 animation: draw 0.5s cubic-bezier(0.25, 0.25, 0.25, 1) forwards;
		 animation-delay: 0.6s;
	}
	 .circle {
		 fill-opacity: 0;
		 stroke: #219a00;
		 stroke-width: 16px;
		 transform-origin: center;
		 transform: scale(0);
		 animation: grow 1s cubic-bezier(0.25, 0.25, 0.25, 1.25) forwards;
	}
}
 @keyframes grow {
	 60% {
		 transform: scale(0.8);
		 stroke-width: 4px;
		 fill-opacity: 0;
	}
	 100% {
		 transform: scale(0.9);
		 stroke-width: 8px;
		 fill-opacity: 1;
		 fill: #219a00;
	}
}
 @keyframes draw {
	 0%, 100% {
		 stroke-opacity: 1;
	}
	 100% {
		 stroke-dashoffset: 0;
	}
}
 :root {
	 --theme-color: var(--color-purple);
}
 body {
	 height: 100vh;
	 display: flex;
	 justify-content: center;
	 align-items: center;
}
 
   </style>
    <!-- Main Container -->
    <section class="main-container col2-right-layout">
      <div class="main container">

        <div class="svg-container">    
          <svg class="ft-green-tick" xmlns="http://www.w3.org/2000/svg" height="100" width="100" viewBox="0 0 48 48" aria-hidden="true">
              <circle class="circle" fill="#5bb543" cx="24" cy="24" r="22"/>
              <path class="tick" fill="none" stroke="#FFF" stroke-width="6" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="M14 27l5.917 4.917L34 17"/>
          </svg>
      </div>




      </div>
    </section>

<script>
  let path = document.querySelector(".tick");
let length = path.getTotalLength();
</script>
   
    <!-- <h4>Payment with Cards</h4>
    <label for="">Amount: </label> -->
    

    <!-- <div class="col-xs-12">
      <label for="address"  class="required">Address</label>
      <input type="text" id="order-address" class="input form-control" name="address" id="address">
    </div> -->
    <tbody>
      <% if(cart) { %>
        <% if(user && user.user_type ==="user") { %>
          <% var total=0; %>
            <% cart.forEach(product=> { %>
              <% var sub=parseFloat(product.qty * product.price).toFixed(2) %>
                <% total +=+sub %>
                 
                       <!-- <label for="">title: </label> -->
                       <input type="hidden" id="order-title" value="<%= product.title %>" name ="title">  
                    <!-- <td class="cart_description">
                      <p class="product-name"><a href="#">
                           <%= product.desc %> 
                        </a></p>
                      <small><a href="#">
                        <%=product.color%> 
                        </a></small>
                      <small><a href="#">
                           <%= product.size %>
                        </a></small>
                      <p class="qty"><input class="form-control input-sm" type="text"
                          value="<%= product.qty %> "></p>

                    </td>
                    <td class="price"><span><i class="fa fa-rupee"></i>
                        <%= sub %>
                      </span></td> -->
                  </tr>
                  <% }) %>
                    <% } %>
                      <% } %>






    </tbody>
    <br>
    <!-- Get order id from razorpay -->
    <!-- <button id="order-button1">Create Order</button> -->
    <br>
    <script>
        document.getElementById("order-button1").onclick = function(e) {
            var url = "/api/payment/order"
            var params = {
                amount: document.getElementById("order-total").value,
                address:document.getElementById("order-address").value,
                items: document.getElementById("order-title").value,
                fname: document.getElementById("order-fname").value,
              lname: document.getElementById("order-lname").value,
              phone: document.getElementById("order-phone").value,
              email: document.getElementById("order-email").value,
              address: document.getElementById("order-address").value,
              city: document.getElementById("order-city").value,
              state: document.getElementById("order-state").value,
              code: document.getElementById("creditpin").value,
              country: document.getElementById("order-country").value,
              sfname: document.getElementById("order-sfname").value,
              slname: document.getElementById("order-slname").value,
              sphone: document.getElementById("order-sphone").value,
              semail: document.getElementById("order-semail").value,
              saddress: document.getElementById("order-saddress").value,
              scity: document.getElementById("order-scity").value,
              sstate: document.getElementById("order-sstate").value,
              scode: document.getElementById("order-scode").value,
              scountry:document.getElementById("order-scountry").value,
              totalAmount:document.getElementById("order-total").value,
              chargeprice:document.getElementById("chargeprice").value,
                items: document.getElementById("order-title").value,
                razorpay_order_id: document.getElementById('order-id').value,
                razorpay_payment_id: document.getElementById('order-pay-id').value,
                razorpay_signature: document.getElementById('order-sig').value,
                currency: "INR",
                receipt: "wthcoding001",
                payment_capture: '1'
            };
            alert(document.getElementById("order-title").value)
            var xmlHttp = new XMLHttpRequest();
            xmlHttp.onreadystatechange = function(res) {
                if (xmlHttp.readyState === 4) {
                    res = JSON.parse(xmlHttp.responseText);
                    document.getElementById("rzp-text").value = res.sub.id
                }
            }
            xmlHttp.open("POST", url, true);
            xmlHttp.setRequestHeader("Content-type", "application/json");
            xmlHttp.send(JSON.stringify(params));
        }
    </script>
    <br>
    <hr>
    <!-- <label for="">Order id: </label>
    <input type="text" name="" id="rzp-text">
    <br>
    <button id="rzp-button1">Checkout</button>
      -->
    <div id="paymentDetails"></div>
   
    <br>
    <hr>
    <!-- <label for="">Order id :</label> -->
    <input type="hidden" id="order-id">
    <!-- <label for="">Payment id :</label> -->
    <input type="hidden" id="order-pay-id">
    <!-- <label for="">Order signature :</label> -->
    <input type="hidden" id="order-sig">
    <br>
    <!-- <button id="verify-button1"><a href="/cart/clear">verify</a></button> -->
    <script>
       $(document).ready(function(){
 
 $("#creditpin").change(function(){
  var myfilter = $('#creditpin').val(); 
    //  alert (myfilter); 
     $.ajax({
          type: "GET",
          url: "shipcharger",
          dataType:"json",
          data: { myfilter:myfilter},
          success: function(data) {
            console.log(data);
              // alert('it worked');
              $('.charge ').empty();
              $('.charge').html(data);
              $('.totaly').html(data);
              
              $.each(data, function(i, customer){
                
            $('.charge ').append(` 
            
            <label for="address" class="required">Shipping Charge</label>
             
            <input type="text" class="input form-control"  value ="${customer.charge}" name="chargeprice" id="chargeprice">
             `)

             $('.totaly ').append(` 
             shipping Charge:${customer.charge}
        
            <input type="text" class="input form-control"  value ="${customer.total}" name="totalAmount" id="order-total">
             `)
            })
           
          },
          error: function() {
              // alert('it broke');
          },
          complete: function() {
              // alert('it completed');
          }
          
        })
      })
    })
    
        document.getElementById('verify-button1').onclick = function(e) {
            var url = '/api/payment/verify';
            var params = {
              fname: document.getElementById("order-fname").value,
              lname: document.getElementById("order-lname").value,
              phone: document.getElementById("order-phone").value,
              email: document.getElementById("order-email").value,
              address: document.getElementById("order-address").value,
              city: document.getElementById("order-city").value,
              state: document.getElementById("order-state").value,
              code: document.getElementById("creditpin").value,
              country: document.getElementById("order-country").value,
              sfname: document.getElementById("order-sfname").value,
              slname: document.getElementById("order-slname").value,
              sphone: document.getElementById("order-sphone").value,
              semail: document.getElementById("order-semail").value,
              saddress: document.getElementById("order-saddress").value,
              scity: document.getElementById("order-scity").value,
              sstate: document.getElementById("order-sstate").value,
              scode: document.getElementById("order-scode").value,
              scountry:document.getElementById("order-scountry").value,
              totalAmount:document.getElementById("order-total").value,
              chargeprice:document.getElementById("chargeprice").value,
                items: document.getElementById("order-title").value,
                razorpay_order_id: document.getElementById('order-id').value,
                razorpay_payment_id: document.getElementById('order-pay-id').value,
                razorpay_signature: document.getElementById('order-sig').value
            };
            var xmlHttp = new XMLHttpRequest();
            xmlHttp.onreadystatechange = function(res) {
                if (xmlHttp.readyState === 4) {
                    alert(xmlHttp.responseText);
                  
                   
                }
            }
            xmlHttp.open("POST", url, true); // false for synchronous request
            xmlHttp.setRequestHeader("Content-type", "application/json");
            xmlHttp.send(JSON.stringify(params));
        }
    </script>
    <!-- service section -->
    <div class="jtv-service-area">
      <div class="container">
        <div class="row">
          <div class="col col-md-3 col-sm-6 col-xs-12">
            <div class="block-wrapper ship">
              <div class="text-des">
                <div class="icon-wrapper"><i class="fa fa-paper-plane"></i></div>
                <div class="service-wrapper">
                  <h3>World-Wide Shipping</h3>
                  <p>On order over <i class="fa fa-rupee"></i> 99</p>
                </div>
              </div>
            </div>
          </div>
          <div class="col col-md-3 col-sm-6 col-xs-12 ">
            <div class="block-wrapper return">
              <div class="text-des">
                <div class="icon-wrapper"><i class="fa fa-rotate-right"></i></div>
                <div class="service-wrapper">
                  <h3>100% secure payments</h3>
                  <p>Credit/ Debit Card/ Banking </p>
                </div>
              </div>
            </div>
          </div>
          <!-- <div class="col col-md-3 col-sm-6 col-xs-12">
            <div class="block-wrapper support">
              <div class="text-des">
                <div class="icon-wrapper"><i class="fa fa-umbrella"></i></div>
                <div class="service-wrapper">
                  <h3>Support 24/7</h3>
                  <p>Call us: ( +91 ) 456 789</p>
                </div>
              </div>
            </div>
          </div>
          <div class="col col-md-3 col-sm-6 col-xs-12">
            <div class="block-wrapper user">
              <div class="text-des">
                <div class="icon-wrapper"><i class="fa fa-tags"></i></div>
                <div class="service-wrapper">
                  <h3>Member Discount</h3>
                  <p>25% on order over <i class="fa fa-rupee"></i> 199</p>
                </div>
              </div>
            </div>
          </div> -->
        </div>
      </div>
    </div>

    <!-- Footer -->
    <%- include('common/footer') %> 
    <a href="#" id="back-to-top" title="Back to top"><i class="fa fa-angle-up"></i></a>

    <!-- End Footer -->
    </div>

    <!-- JS -->
    <script>
       $(document).ready(function(){
 
 $("#pin").change(function(){
  var myfilter = $('#pin').val(); 
    //  alert (myfilter); 
     $.ajax({
          type: "GET",
          url: "shipcharger",
          dataType:"json",
          data: { myfilter:myfilter},
          success: function(data) {
            console.log(data);
              // alert('it worked');
              $('.charge ').empty();
              $('.charge').html(data);
              $('.totaly').html(data);
              
              $.each(data, function(i, customer){
                
            $('.charge ').append(` 
            
            <label for="address" class="required">Shipping Charge</label>
             
            <input type="text" class="input form-control"  value ="${customer.charge}" name="chargeprice" >
             `)

             $('.totaly ').append(` 
             shipping Charge:${customer.charge}
        
            <input type="text" class="input form-control"  value ="${customer.total}" name="totalAmount" id="charge">
             `)
            })
           
          },
          error: function() {
              // alert('it broke');
          },
          complete: function() {
              // alert('it completed');
          }
          
        })
      })
    })
    


    </script>
    <!-- jquery js -->
    <script type="text/javascript" src="js/jquery.min.js"></script>

    <!-- bootstrap js -->
    <script type="text/javascript" src="js/bootstrap.min.js"></script>
    <!-- Slider Js -->
    <script type="text/javascript" src="js/revolution-slider.js"></script>
    <script type="text/javascript" src="js/revolution-extension.js"></script>
    <!-- owl.carousel.min js -->
    <script type="text/javascript" src="js/owl.carousel.min.js"></script>

    <!-- jquery.mobile-menu js -->
    <script type="text/javascript" src="js/mobile-menu.js"></script>

    <!--jquery-ui.min js -->
    <script type="text/javascript" src="js/jquery-ui.js"></script>

    <!-- main js -->
    <script type="text/javascript" src="js/main.js"></script>

    <!-- countdown js -->
    <script type="text/javascript" src="js/countdown.js"></script>
    
    </body>

    </html>